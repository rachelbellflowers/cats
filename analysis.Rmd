---
title: "Analysis of The Characteristics of the Oldest Living Cats"
always_allow_html: true
author: "beep"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    keep_md: true
bibliography: references.bib  
nocite: '@*'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#knitr::write_bib(c("knitr", "plotly", "xml2", "rvest", "tidyverse", "ggthemes"), "references.bib")

library(xml2)
library(rvest)
library(tidyverse)
library(plotly)
library(ggthemes)

cats <- "https://en.wikipedia.org/wiki/List_of_oldest_cats"

table <- read_html(cats) %>%
  html_nodes(xpath = '/html/body/div[3]/div[3]/div[5]/div[1]/table[2]') %>%
  html_table(fill = TRUE)

table <- table[[1]]

table <- table[-29, -c(9, 11:12)]

table[table == ""] <- NA

colnames(table)[5] <- "reported_age"

table[5] <- c("38.0082191780822", "38", "36.0027397260274", "34.4109589041096", "34.1643835616438", "33.4986301369863", "33", "33", "31.1643835616438", "32", "31.9150684931507", "31.1643835616438", "31", "30.1123287671233", "30", "30", "29", "29", "28", "28", "28", "27.1917808219178", "27", "27", "27", "27", "26.0712328767123", "26")

table$reported_age <- as.numeric(table$reported_age)

```

---

## Introduction

This is an analysis of an unofficial list from [Wikipedia](https://en.wikipedia.org/wiki/List_of_oldest_cats) of world's oldest cats. The reported ages range from precise to vague estimates. The minimum age requirement for cats to be added to this list was 25 years old. Despite this dataset being small and imprecise, I hope by examining it to discover possible factors contributing to these cats' longevity. 

---

## Method

To obtain this dataset, I used the `rvest` package to webscrape the table from its Wikipedia page. In the case of cats with imprecise ages, I calculated their approximate age. For instance, if a cat was listed as being 29 years old and 8 months, I inputted their age as $29 + (8 * 30 )/365 = 29.6575$ days. Then, I used the `plotly` package to create visualizations.

---

## Exploratory Analysis

<br>

```{r}
tab_age <- table %>%
  mutate(Name = fct_reorder(Name, reported_age)) 

ages <- plot_ly(tab_age, x = ~Name, y = ~reported_age, type = "bar")

ages <- ages %>% layout(title = "Ages and Names", yaxis = list(title = "Reported age"))
                        
ages
```


<br><br>


```{r country}

country <- plot_ly(table, x = ~Country, type = "histogram")
 
country <- country %>% layout(title = "Country of Origin")
 
country
```

<br>
<br>

```{r breed}
breed <- plot_ly(table, x = ~Breed, type = "histogram")

breed <- breed %>% layout(title = "Cat Breeds")

breed
```

<br>
<br>


```{r sex}

sex <- plot_ly(table, x = ~Sex, type = "histogram")

sex <- sex %>% layout(title = "Count of Sex")

sex
```

---

```{r include = FALSE}

# Making sex numeric

table$sex_num <- table$Sex
table$sex_num[which(table$Sex == "female")] <- "1"
table$sex_num[which(table$Sex == "male")] <- "0"
table$sex_num <- as.numeric(table$sex_num)

# Making country numeric

table$country_num <- table$Country
table$country_num[which(table$Country == "Australia")] <- "0"
table$country_num[which(table$Country == "Canada")] <- "1"
table$country_num[which(table$Country == "New Zealand")] <- "2"
table$country_num[which(table$Country == "Sweden")] <- "3"
table$country_num[which(table$Country == "Switzerland")] <- "4"
table$country_num[which(table$Country == "United Kingdom")] <- "5"
table$country_num[which(table$Country == "United States")] <- "6"
table$country_num <- as.numeric(table$country_num)

# Preparing columns for t tests


males <- table$reported_age[which(table$sex_num == 0)]
females <- table$reported_age[which(table$sex_num == 1)]



aus <- table$reported_age[which(table$Country == "Australia")]
us <- table$reported_age[which(table$Country == "United States")]
uk <- table$reported_age[which(table$Country == "United Kingdom")]
nz <- table$reported_age[which(table$Country == "New Zealand")]
swit <- table$reported_age[which(table$Country == "Switzerland")]
swed <- table$reported_age[which(table$Country == "Sweden")]
can <- table$reported_age[which(table$Country == "Canada")]


# T tests

var.test(males, females) # > 0.05
t.test(males, females, var.equal = TRUE) # t = 0.51665, p = 0.6099

var.test(us, uk) # > 0.05
t.test(us, uk, var.equal = TRUE) # t = 0.34046, p > 0.05

var.test(us, can) # < 0.05
t.test(us, can, var.equal = FALSE) # t = 2.0606, p > 0.05

var.test(uk, can) # < 0.05
t.test(uk, can, var.equal = FALSE) # t = 3.1346, p < 0.05
```



# References
